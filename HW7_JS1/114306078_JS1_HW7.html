<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
</head>
<body>
	<h1>114306078_HW7_1A2B</h1>

	Enter 4 unique numbers
	<input type="text" id="guessInput">
	<button onclick="play()">Guess</button>
	<div id="record">Game Record:<br></div>

	<script>
		var answer = generateAnswer();
		console.log("Secret Answer:", answer);
		var attempts = 0;

		function generateAnswer(){
			var digits = [0,1,2,3,4,5,6,7,8,9];
			var answer = "";
			for (var i = 1; i <= 4; i++) {
            	var index = Math.floor(Math.random() * digits.length);
            	answer += digits[index];
            	digits.splice(index, 1);
			}
			return answer;
		}

		function play(){
			var input = document.getElementById("guessInput").value;
			 if (!isValid(input)) {
            	alert("Invalid input! Please enter 4 unique digits.");
            	document.getElementById("guessInput").value = "";
            	return;
        	}
        	attempts++;
        	var result = checkAB(input, answer);
        	var record = document.getElementById("record");
        	record.innerHTML += "第" + attempts + "次 " + input + " → "+result +"<br>";
        	if (result === "4A0B") {
            	alert("Correct! You guessed the answer in " + attempts + " attempts.");
            	 document.getElementById("guessInput").disabled = true;
        	}
        	document.getElementById("guessInput").value = "";
		}

		function isValid(str){
			if (!/^\d{4}$/.test(str)) return false;
			var set = new Set(str);
        	return set.size === 4;
		}
		
		function checkAB(guess, ans){
			var A = 0;
        	var B = 0;

        	for (let i = 0; i < 4; i++) {
            	if (guess[i] === ans[i]) {
                	A++;
            	} else if (ans.includes(guess[i])) {
                	B++;
            	}
        	}
        	return A + "A" + B + "B";
		}
	</script>
</body>
</html>